@{
    @using ViewModels.SharePlus;
    @model SharePlusViewModel;
}

<div style="align-self: center; margin-bottom: 2rem; margin-top: 1rem;">
    <h3>Welcome to the translate plus Knowledge Base</h3>
</div>
<div class="text-center">
    @*<div class="d-block text-center" style="margin-bottom: 1rem; padding-top: 2rem;">
            <h6 class="d-inline p-2 text-white bg-dark"> Here is a Kanye West quote : </h6>
        </div>*@
    <div class="d-inline p-2 text-center font-weight-light" style="line-height: 37px; margin-bottom: 2rem;">
        @Model.InspirationalQuote
    </div>
</div>
<div class="input-group input-group-lg mb-5 shadow-1 rounded">
    <input type="text" class="form-control shadow-inset-2" id="searchField" name="searchTerm" aria-label="type 2 or more letters" placeholder="Search anything...">
    <div class="input-group-append">
        <button class="btn btn-primary hidden-sm-down" id="search-btn" type="button"><i class="@(Settings.Theme.IconPrefix) fa-search mr-lg-2"></i><span class="hidden-md-down">Search</span></button>
        @*<button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <span class="sr-only">Toggle Dropdown</span>
            </button>
            <div class="dropdown-menu dropdown-menu-right">
                <a class="dropdown-item" href="#">Data</a>
                <a class="dropdown-item" href="#">Images</a>
                <a class="dropdown-item" href="#">Users</a>
                <div role="separator" class="dropdown-divider"></div>
                <a class="dropdown-item active" href="#">Everything</a>
            </div>*@
    </div>
</div>
@if (Model.IsAllowedToEdit == true)
{
    <div class="text-center">
        <a asp-action="Create" class="btn btn-outline-success" style="margin: 25px;">Add new article</a>
    </div>
}

@if (Model.Pinned != null)
{
    <div class="text-center" style="font-size: initial;">Pinned Articles</div>
    <div class="frame-wrap">
        <table class="table m-0">
            <thead class="thead-dark">
                <tr>
                    @*<th>#</th>*@
                    <th>Title</th>
                    <th>Views</th>
                </tr>
            </thead>
            <tbody>
                @for (int i = 0; i <= Model.Pinned.Count() - 1; i++)
                {
                    <tr>
                        @*<th scope="row">@(i + 1)</th>*@
                        <td><a asp-controller="Articles" asp-action="Article" asp-route-id="@Model.Pinned.ElementAt(i).Id">@Model.Pinned.ElementAt(i).Title</a></td>
                        <td>@Model.Pinned.ElementAt(i).NumberOfTimesViewed     <i class="fal fa-eye"></i></td>
                    </tr>

                }
            </tbody>
        </table>
    </div>
}
<!--<hr />
<div class="frame-wrap">
    <nav aria-label="...">
        <ul class="pagination justify-content-center">-->
@*<li class="page-item disabled">
        <a class="page-link" href="#" aria-label="Previous">
            <span aria-hidden="true"><i class="@(Settings.Theme.IconPrefix) fa-chevron-left"></i></span>
        </a>
    </li>*@
@*@for (int i = 1; i < Model.PageCount + 1; i++)
    {
    @*<li class="page-item active" aria-current="page">
        <span class="page-link">
            @i
            <span class="sr-only">(current)</span>
        </span>
    </li>
    <li class="page-item"><a class="page-link" href="#">@(i+1)</a></li>
    <!--<li class="page-item"><a class="page-link" asp-controller="Articles" asp-action="Articles" asp-route-page="@i">@i</a></li>
    }-->*@
@*<li class="page-item">
        <a class="page-link" href="#" aria-label="Next">
            <span aria-hidden="true"><i class="@(Settings.Theme.IconPrefix) fa-chevron-right"></i></span>
        </a>
    </li>*@
<!--</ul>
    </nav>
</div>-->

@if (Model.MostViewed != null)
{
    <div class="text-center" style="font-size: initial;">Most Viewed Articles</div>

    <div class="frame-wrap">
        <table class="table m-0">
            <thead class="thead-dark">
                <tr>
                    @*<th>#</th>*@
                    <th>Title</th>
                    <th>Views</th>
                </tr>
            </thead>
            <tbody>
                @for (int i = 0; i <= Model.MostViewed.Count() - 1; i++)
                {
                    <tr>
                        @*<th scope="row">@(i + 1)</th>*@
                        <td><a asp-controller="Articles" asp-action="Article" asp-route-id="@Model.MostViewed.ElementAt(i).Id">@Model.MostViewed.ElementAt(i).Title</a></td>
                        <td>@Model.MostViewed.ElementAt(i).NumberOfTimesViewed     <i class="fal fa-eye"></i></td>
                    </tr>

                }
            </tbody>
        </table>
    </div>
}
@if (Model.SearchResult != null)
{
    <div class="text-center text-capitalize">Search results:</div>

    <div class="frame-wrap">
        <table class="table m-0">
            <thead class="thead-dark">
                <tr>
                    @*<th>#</th>*@
                    <th>Title</th>
                    @*<th>Views</th>*@
                </tr>
            </thead>
            <tbody>
                @for (int i = 0; i <= Model.SearchResult.Count() - 1; i++)
                {
                    <tr>
                        @*<th scope="row">@(i + 1)</th>*@
                        <td><a asp-controller="Articles" asp-action="Article" asp-route-id="@Model.SearchResult.ElementAt(i).Id">@Model.SearchResult.ElementAt(i).Value</a></td>
                        @*<td>@Model.SearchResult.ElementAt(i).NumberOfTimesViewed     <i class="fal fa-eye"></i></td>*@
                    </tr>

                }
            </tbody>
        </table>
    </div>
}
<div>
    <p style="line-height: 1.5rem;">
        share plus is an online knowledge base which contains searchable information on all aspects of translate plus, whether to do with IT, accounts procedures, project management processes or sales guidelines.
        For any additional help please contact your line manager, and for IT requests please e-mail ITSupport@translateplus.com. For urgent IT requests please follow up your e-mail with a call to IT.
        If you want to add an article to share plus, please suggest this via your team manager, who will then liaise with <a href="mailto:ITSupport@translateplus.com">IT Support</a> to get it added.
    </p>
</div>


@section ScriptsBlock{
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <script>
        //$(document).ready(function () {
        //    $.ajax({
        //        url: "https://api.kanye.rest/?format=text",
        //        type: "GET",
        //        contentType: "text/plain",
        //        success: function (data) {
        //            $("#kanye").text(data.quote);
        //        },
        //        error: function (req, status, error) {
        //            console.log(error);
        //        }
        //    });
        //});

        $("#searchField").autocomplete({
            source: function (data, cb) {
                $.ajax({
                    url: "api/SharePlusApi/",
                    dataType: 'json',
                    method: 'GET',
                    data: { term: data.term },
                    success: function (res) {
                        cb(res);
                    },
                    error: function (req, status, err) {
                        console.log(status, err);
                    }
                });
            },
            select: function (event, ui) {
                window.location.href = `Articles/Article?id=${ui.item.id}`;
            }
        });

        $("#search-btn").on('click', function () {
            var searchTerm = $("#searchField").val();
            console.log(searchTerm);
            window.location.href = `Articles/Articles/${searchTerm}`;
        })
    </script>
}